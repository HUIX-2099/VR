<html>
  <head>
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    <style>
      #posHud {
        position: fixed;
        top: 10px;
        left: 10px;
        padding: 6px 8px;
        background: rgba(0, 0, 0, 0.6);
        color: #fff;
        font-family: monospace;
        font-size: 14px;
        line-height: 1.2;
        border-radius: 4px;
        z-index: 9999;
        white-space: pre;
        user-select: text;
      }
      #posTools { position: fixed; top: 80px; left: 10px; z-index: 10000; display: flex; gap: 6px; align-items: center; }
      #glbPosInput { width: 260px; font-family: monospace; font-size: 13px; padding: 4px 6px; }
      #copyGlbBtn { padding: 4px 8px; font-size: 13px; }
    </style>
  </head>
  <body>
    <div id="posHud"></div>
    <div id="posTools">
      <input id="camWorldInput" type="text" readonly value="position=\"0 0 0\"" />
      <button id="copyCamBtn" type="button">Copy Camera</button>
      <input id="rigWorldInput" type="text" readonly value="position=\"0 0 0\"" />
      <button id="copyRigBtn" type="button">Copy Rig</button>
      <input id="glbPosInput" type="text" readonly value="position=\"0 0 -3\"" />
      <button id="copyGlbBtn" type="button">Copy GLB</button>
    </div>
    <a-scene show-pos>
      <a-assets>
        <a-asset-item id="model" src="meausum.glb"></a-asset-item>
      </a-assets>
      <!-- //player -->
      <a-entity id="rig" position="0 1.2 0">
        <a-entity camera look-controls wasd-controls="acceleration: 20" position="7.28 3.60 26.95"></a-entity>
      </a-entity>
      <a-entity id="glb" gltf-model="#model" position="0 0 -3" scale="2.5 2.5 2.5"></a-entity>
      <a-sky color="orange"></a-sky>
    </a-scene>
    <script>
      AFRAME.registerComponent('show-pos', {
        init: function () {
          this.hud = document.getElementById('posHud');
          this.rig = document.getElementById('rig');
          this.glb = document.getElementById('glb');
          this.cam = this.el.querySelector('[camera]');
          // Vectors may require THREE to be ready; guard it
          this._vCam = (window.THREE && new THREE.Vector3()) || {x:0,y:0,z:0};
          this._vRig = (window.THREE && new THREE.Vector3()) || {x:0,y:0,z:0};
          this._vGlb = (window.THREE && new THREE.Vector3()) || {x:0,y:0,z:0};
          // Copy helpers
          this.glbPosInput = document.getElementById('glbPosInput');
          this.camWorldInput = document.getElementById('camWorldInput');
          this.rigWorldInput = document.getElementById('rigWorldInput');
          var attachCopy = (btnId, inputEl) => {
            var btn = document.getElementById(btnId);
            if (!btn || !inputEl) return;
            btn.addEventListener('click', () => {
              var text = inputEl.value;
              if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text);
              } else {
                inputEl.select();
                document.execCommand('copy');
              }
            });
          };
          attachCopy('copyGlbBtn', this.glbPosInput);
          attachCopy('copyCamBtn', this.camWorldInput);
          attachCopy('copyRigBtn', this.rigWorldInput);
        },
        tick: function () {
          if (!this.hud) return;
          // If camera not found yet (DOM not fully parsed), try again
          if (!this.cam) this.cam = this.el.querySelector('[camera]');
          if (this.cam && this.cam.object3D) this.cam.object3D.getWorldPosition(this._vCam);
          if (this.rig && this.rig.object3D) this.rig.object3D.getWorldPosition(this._vRig);
          if (this.glb && this.glb.object3D) this.glb.object3D.getWorldPosition(this._vGlb);
          var fmt = function (v) { return v.x.toFixed(2) + ' ' + v.y.toFixed(2) + ' ' + v.z.toFixed(2); };
          this.hud.textContent = 'camera world="' + fmt(this._vCam) + '"\n'
            + 'rig world="' + fmt(this._vRig) + '"\n'
            + 'glb world="' + fmt(this._vGlb) + '"';
          // Update copyable GLB attribute string
          if (this.glbPosInput) {
            var localGlb = this.glb ? this.glb.getAttribute('position') : {x:0,y:0,z:0};
            this.glbPosInput.value = 'position="' + localGlb.x.toFixed(2) + ' ' + localGlb.y.toFixed(2) + ' ' + localGlb.z.toFixed(2) + '"';
          }
          // Update copyable camera and rig world positions
          var toAttr = (v) => 'position="' + v.x.toFixed(2) + ' ' + v.y.toFixed(2) + ' ' + v.z.toFixed(2) + '"';
          if (this.camWorldInput) this.camWorldInput.value = toAttr(this._vCam);
          if (this.rigWorldInput) this.rigWorldInput.value = toAttr(this._vRig);
        }
      });
    </script>
  </body>
</html>